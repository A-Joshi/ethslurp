clear

echo "	test1: default behaviour should show help"
rm -fR ~/.ethslurp.test
cat api_key | ../ethslurp -t >proposed/test1.txt
find ~/.ethslurp.test >>proposed/test1.txt 2>/dev/null # should be empty

echo
echo "Running ethslurp test suite..."
echo

echo "	test2: slurp on known dead account"
../ethslurp -t 0x713B73c3994442b533e6A083eC968e40606810Ec >proposed/test2.txt
cat ~/.ethslurp.test/config.dat | grep -v api_key >>proposed/test2.txt

echo "	test3: test last visited flag"
../ethslurp -t -l >proposed/test3.txt

echo "	test4: test prettyPrint flag"
../ethslurp -t -l -f >proposed/test4.txt ; ./strip_confirms 4;
sleep 1s

echo "	test5: test tab delimited flag"
../ethslurp -t -v -l -f:txt >proposed/test5.txt

echo "	test6: test comma seperated value flag"
../ethslurp -t -v -l -f:csv >proposed/test6.csv

echo "	test7: test html flag"
../ethslurp -t -v -l -f:html >proposed/test7.html
sleep 1s

echo "	test8: extract income records only"
../ethslurp -t -v -i -f 0x682e426ea761db77bacd5acdce33ca122175daea >proposed/test8.txt

echo "	test9: extract expense records only"
../ethslurp -t -v -e -f 0x682e426ea761db77bacd5acdce33ca122175daea >proposed/test9.txt
sleep 1s

echo "	test10: test date option (not implemented)"
../ethslurp -t -d -l -f 0x713B73c3994442b533e6A083eC968e40606810Ec >proposed/test10.txt

echo "	test11: test open option (not implemented)"
../ethslurp -t -o -l -f >proposed/test11.txt

echo "	test12: test backup option (not implemented)"
../ethslurp -t -b -l -f >proposed/test12.txt
sleep 1s

echo "	test14: test custom display strings, file: format and fmt_ format"
echo "fmt_custom_file=file:custom_format_file.html" >>~/.ethslurp.test/config.dat
echo "fmt_custom_record=fmt_html_record"            >>~/.ethslurp.test/config.dat
echo "fmt_custom_field=fmt_html_field"              >>~/.ethslurp.test/config.dat
cat ~/.ethslurp.test/config.dat | grep -v api_key    >proposed/test14.txt
../ethslurp -t -l -f:custom                         >>proposed/test14.txt

echo "	testlast: test cache clear option"
ls ~/.ethslurp.test/slurps   >proposed/testlast.txt
../ethslurp -t -c           >>proposed/testlast.txt
find ~/.ethslurp.test       >>proposed/testlast.txt

# now diff to see if anything changed
echo "----------------------------"
echo " Doing a 'diff.' If anything shows below, you "
echo " either broke something or you have to update gold."
echo "----------------------------"
diff -r proposed gold
echo
